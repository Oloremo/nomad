<div class="job-status-panel boxed-section">
  <div class="boxed-section-head">
    <h2>Status</h2>
    <div class="select-mode">
      <button type="button"
        class="button is-small is-borderless {{if (eq this.mode "current") "is-active"}}"
        {{on "click" (action (mut this.mode) "current")}}
      >
        Current
      </button>
      <button type="button"
        class="button is-small is-borderless {{if (eq this.mode "historical") "is-active"}}"
        {{on "click" (action (mut this.mode) "historical")}}>
        Historical
      </button>
    </div>
  </div>
  {{#if this.showDataFaker}}
    <form class="fake-box-for-manipulating-allocs">
      <header>Manipulate mock data:</header>
      {{#each this.allocTypes as |type|}}
        <label>
          <strong>{{capitalize type.label}}: {{get @job.summary type.property}}</strong>
          <input type="range" 
              {{on "input" (fn this.modifyMockAllocs type.property)}}
              min="0"
              max="100"
              value={{get @job.summary type.property}}
              steps="1">
        </label>
      {{/each}}
    </form>
  {{/if}}
  <div class="boxed-section-body">
    {{#if (eq this.mode "current")}}
      <h3 class="title is-4 running-allocs-title"><strong>{{@job.runningAllocs}}/{{this.totalAllocs}}</strong> Allocations Running</h3>

      <JobStatus::AllocationRow @totalAllocs={{this.totalAllocs}}
        @allocBlocks={{this.allocBlocks}}
      />

      <footer>
        <legend>
          {{#each this.allocTypes as |type|}}
            <span class="legend-item {{if (eq (get this.allocBlocks type.label) 0) "faded"}}">
              <span class="represented-allocation {{type.label}}"></span>
              {{get (get this.allocBlocks type.label) "length"}} {{capitalize type.label}}
            </span>
          {{/each}}
        </legend>

        <section class="versions">
          <h4>Versions</h4>
          {{!-- {{log "what can i know about versions" @job.runningAllocs this.allocBlocks}} --}}
          <ul>
            {{#each-in this.versions as |version allocs|}}
              <li>
                <strong>{{version}}</strong>
                <span>{{allocs.length}}</span>
              </li>
            {{/each-in}}
          </ul>
        </section>
      </footer>
    {{/if}}
    {{#if (eq this.mode "historical")}}
      But what about before?
    {{/if}}
  </div>
</div>